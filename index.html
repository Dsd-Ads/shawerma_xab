<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ú–µ–Ω—é –®–∞—É—Ä–º–∞ –•–∞–±</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: var(--tg-theme-bg-color, #ffffff);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #f4f4f7);
            --text-color: var(--tg-theme-text-color, #000000);
            --hint-color: var(--tg-theme-hint-color, #707579);
            --button-color: var(--tg-theme-button-color, #248b91);
            --button-text: var(--tg-theme-button-text-color, #ffffff);
        }
        body { font-family: -apple-system, sans-serif; background: var(--bg-color); color: var(--text-color); margin: 0; padding: 0; overflow-x: hidden; }
        #app { padding: 15px; padding-bottom: 100px; }
        .category-title { font-size: 1.1rem; font-weight: 800; text-transform: uppercase; color: var(--button-color); margin: 25px 0 12px; border-left: 5px solid var(--button-color); padding-left: 10px; }
        .item-card { background: var(--secondary-bg); border-radius: 16px; padding: 14px; margin-bottom: 12px; border: 1px solid rgba(0,0,0,0.05); }
        .item-header { display: flex; justify-content: space-between; align-items: flex-start; }
        .item-name { font-size: 1rem; font-weight: 700; flex: 1; }
        .item-price { font-weight: 800; color: var(--button-color); margin-left: 10px; }
        .item-desc { font-size: 0.8rem; color: var(--hint-color); margin: 6px 0 12px; line-height: 1.2; }
        .controls { display: flex; justify-content: flex-end; align-items: center; margin-top: 10px; }
        .qty-box { display: flex; align-items: center; background: var(--bg-color); border-radius: 10px; padding: 2px; }
        .btn-qty { background: var(--button-color); color: var(--button-text); border: none; border-radius: 8px; width: 36px; height: 36px; font-weight: bold; font-size: 1.4rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .qty-num { margin: 0 15px; font-weight: 700; font-size: 1.1rem; min-width: 20px; text-align: center; }
        .addon-section { display: none; margin-top: 12px; padding-top: 12px; border-top: 1px dashed rgba(0,0,0,0.1); }
        .addon-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .addon-item { display: flex; align-items: center; font-size: 0.8rem; background: var(--bg-color); padding: 8px; border-radius: 8px; }
        .addon-item input { margin-right: 8px; width: 18px; height: 18px; }
        textarea { width: 100%; margin-top: 10px; border-radius: 10px; border: 1px solid rgba(0,0,0,0.1); padding: 10px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); box-sizing: border-box; resize: none; }
    </style>
</head>
<body>
    <div id="app">
        <div id="menu-content"></div>
    </div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const menuData = [
        {
            category: "üåØ –®–∞—É—Ä–º–∞",
            items: [
                { id: "sh_kur_st", name: "–®–∞—É—Ä–º–∞ –∫—É—Ä–∏—Ü–∞ (–°—Ç–∞–Ω–¥–∞—Ä—Ç)", price: 290, desc: "390–≥. –û–≤–æ—â–∏, —Å–æ—É—Å—ã, –∫–æ—Ä–µ–π—Å–∫–∞—è –º–æ—Ä–∫–æ–≤—å" },
                { id: "sh_kur_big", name: "–®–∞—É—Ä–º–∞ –∫—É—Ä–∏—Ü–∞ (–ë–æ–ª—å—à–∞—è)", price: 350, desc: "500–≥. –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –ø–æ—Ä—Ü–∏—è" },
                { id: "sh_svin_st", name: "–®–∞—É—Ä–º–∞ —Å–≤–∏–Ω–∏–Ω–∞ (–°—Ç–∞–Ω–¥–∞—Ä—Ç)", price: 320, desc: "390–≥. –û–≤–æ—â–∏, —Å–æ—É—Å—ã, –º–∞—Ä–∏–Ω–æ–≤–∞–Ω–Ω—ã–π –ª—É–∫" },
                { id: "sh_svin_big", name: "–®–∞—É—Ä–º–∞ —Å–≤–∏–Ω–∏–Ω–∞ (–ë–æ–ª—å—à–∞—è)", price: 390, desc: "500–≥. –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –ø–æ—Ä—Ü–∏—è" },
                { id: "sh_skum", name: "–®–∞—É—Ä–º–∞ —Å–∫—É–º–±—Ä–∏—è", price: 340, desc: "355–≥. –°–∫—É–º–±—Ä–∏—è –∑–∞–ø–µ—á–µ–Ω–Ω–∞—è, —Ç–µ—Ä–∏—è–∫–∏" },
                { id: "sh_hab", name: "üåü –®–∞—É—Ä–º–∞ –•–ê–ë", price: 390, desc: "330–≥. –û–≤–æ—â–∏ –≥—Ä–∏–ª—å, –∞–¥–∂–∏–∫–∞, —Å–æ—É—Å —Ñ–µ—Ç–∞" }
            ]
        },
        {
            category: "üçî –ë—É—Ä–≥–µ—Ä—ã",
            items: [
                { id: "br_tiftik", name: "–¢–∏—Ñ—Ç–∏–∫ –±—É—Ä–≥–µ—Ä", price: 570, desc: "280–≥. –†–≤–∞–Ω–∞—è –≥–æ–≤—è–¥–∏–Ω–∞, –æ–≤–æ—â–∏, –º–æ—Ü–∞—Ä–µ–ª–ª–∞" },
                { id: "br_black", name: "–ë—É—Ä–≥–µ—Ä –ë–ª—ç–∫", price: 460, desc: "315–≥. –ö–æ—Ç–ª–µ—Ç–∞ —Å–≤–∏–Ω–æ-–≥–æ–≤—è–∂—å—è, –æ–≤–æ—â–∏, —Å—ã—Ä" },
                { id: "br_chef", name: "–®–µ—Ñ –ë—É—Ä–≥–µ—Ä –≥–æ–≤—è–¥–∏–Ω–∞", price: 470, desc: "320–≥. –ö–æ—Ç–ª–µ—Ç–∞ –≥–æ–≤—è–∂—å—è, —Å—ã—Ä, –æ–≤–æ—â–∏" },
                { id: "br_ananas", name: "–ë—É—Ä–≥–µ—Ä –ê–Ω–∞–Ω–∞—Å", price: 520, desc: "380–≥. –ö–æ—Ç–ª–µ—Ç–∞ –≥–æ–≤—è–∂—å—è, –∞–Ω–∞–Ω–∞—Å" },
                { id: "br_chkalov", name: "–ë—É—Ä–≥–µ—Ä –ß–∫–∞–ª–æ–≤—Å–∫–∏–π", price: 540, desc: "400–≥. –ö—É—Ä–∏—Ü–∞ –≤ –ø–∞–Ω–∏—Ä–æ–≤–∫–µ, —Å—ã—Ä, –∫–∞—Ä—Ä–∏" },
                { id: "br_fish", name: "–§–∏—à –±—É—Ä–≥–µ—Ä", price: 340, desc: "205–≥. –†—ã–±–Ω–∞—è –∫–æ—Ç–ª–µ—Ç–∞, —Å–æ—É—Å —Ç–∞—Ä—Ç–∞—Ä" },
                { id: "br_chiken", name: "–ß–∏–∫–µ–Ω –≥—Ä–∏–±–±—É—Ä–≥–µ—Ä", price: 360, desc: "170–≥. –ö—É—Ä–∏–Ω–∞—è –∫–æ—Ç–ª–µ—Ç–∞, –∂—é–ª—å–µ–Ω, —Å—ã—Ä" }
            ]
        },
        {
            category: "üå≠ –•–æ—Ç-–¥–æ–≥–∏",
            items: [
                { id: "hd_cl", name: "–•–æ—Ç-–¥–æ–≥ –∫–ª–∞—Å—Å–∏–∫", price: 320, desc: "185–≥. –°–æ—Å–∏—Å–∫–∞, —Å—ã—Ä, –æ–≤–æ—â–∏, —Å–æ—É—Å—ã" },
                { id: "hd_fr", name: "–§—Ä–µ–Ω—á-–¥–æ–≥ –∫—É—Ä–∏—Ü–∞", price: 270, desc: "150–≥. –°–æ—Å–∏—Å–∫–∞, –ª—É–∫ —Å—É—à–µ–Ω—ã–π, —Å–æ—É—Å—ã" },
                { id: "hd_corn", name: "–ö–æ—Ä–Ω-–¥–æ–≥", price: 370, desc: "100–≥. –ö—É—Ä–∏–Ω–∞—è —Å–æ—Å–∏—Å–∫–∞, —Å—ã—Ä" }
            ]
        },
        {
            category: "üî• –ú–∞–Ω–≥–∞–ª",
            items: [
                { id: "m_lulya_kur", name: "–õ—é–ª—è –∫—É—Ä–∏–Ω—ã–µ", price: 260, desc: "125/70–≥." },
                { id: "m_lulya_sv", name: "–õ—é–ª—è —Å–≤–∏–Ω–æ-–≥–æ–≤—è–∂—å–∏", price: 280, desc: "125/70–≥." },
                { id: "m_shash_bed", name: "–®–∞—à–ª—ã–∫ –∫—É—Ä–∏–Ω–æ–µ –±–µ–¥—Ä–æ", price: 440, desc: "250/80–≥." },
                { id: "m_shash_sv", name: "–®–∞—à–ª—ã–∫ —Å–≤–∏–Ω–∏–Ω–∞", price: 490, desc: "250/80–≥." }
            ]
        },
        {
            category: "ü•£ –°—É–ø—ã",
            items: [
                { id: "s_grib", name: "–°—É–ø-–ø—é—Ä–µ –≥—Ä–∏–±–Ω–æ–π", price: 350, desc: "210–≥." },
                { id: "s_kur", name: "–õ–∞–ø—à–∞ –∫—É—Ä–∏–Ω–∞—è", price: 210, desc: "290–≥." }
            ]
        }
    ];

    const addons = [
        { n: "üßÄ –°—ã—Ä", p: 40 },
        { n: "üî• –•–∞–ª–∞–ø–µ–Ω—å–æ", p: 30 },
        { n: "üçü –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å", p: 30 },
        { n: "ü•í –û–≥—É—Ä–µ—Ü –º–∞—Ä.", p: 20 }
    ];

    let cart = {};

    function render() {
        const container = document.getElementById('menu-content');
        container.innerHTML = ''; 

        menuData.forEach(cat => {
            const catTitle = document.createElement('div');
            catTitle.className = 'category-title';
            catTitle.innerText = cat.category;
            container.appendChild(catTitle);

            cat.items.forEach(item => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.id = `item-${item.id}`;
                card.innerHTML = `
                    <div class="item-header">
                        <div class="item-name">${item.name}</div>
                        <div class="item-price">${item.price}‚ÇΩ</div>
                    </div>
                    <div class="item-desc">${item.desc}</div>
                    <div class="controls">
                        <div class="qty-box">
                            <button class="btn-qty" onclick="changeQty('${item.id}', -1, ${item.price})">‚àí</button>
                            <span class="qty-num" id="q-${item.id}">0</span>
                            <button class="btn-qty" onclick="changeQty('${item.id}', 1, ${item.price})">+</button>
                        </div>
                    </div>
                    <div class="addon-section" id="a-${item.id}">
                        <div class="addon-grid">
                            ${addons.map(a => `<div class="addon-item"><input type="checkbox" class="cb" data-p="${a.p}" data-n="${a.n}" onchange="recalc()"><span>${a.n} (+${a.p}‚ÇΩ)</span></div>`).join('')}
                        </div>
                        <textarea id="c-${item.id}" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –±–ª—é–¥—É..."></textarea>
                    </div>
                `;
                container.appendChild(card);
            });
        });
    }

    window.changeQty = function(id, delta, price) {
        if (!cart[id]) cart[id] = { q: 0, p: price };
        cart[id].q += delta;
        if (cart[id].q < 0) cart[id].q = 0;

        document.getElementById(`q-${id}`).innerText = cart[id].q;
        document.getElementById(`a-${id}`).style.display = cart[id].q > 0 ? 'block' : 'none';
        recalc();
    };

    window.recalc = function() {
        let total = 0;
        let orderData = [];

        for (const id in cart) {
            if (cart[id].q > 0) {
                let itemSum = cart[id].q * cart[id].p;
                const card = document.getElementById(`item-${id}`);
                const ads = [];
                
                card.querySelectorAll('.cb:checked').forEach(c => {
                    itemSum += parseInt(c.dataset.p);
                    ads.push(c.dataset.n);
                });

                total += itemSum;
                orderData.push({
                    name: card.querySelector('.item-name').innerText,
                    q: cart[id].q,
                    addons: ads,
                    comment: document.getElementById(`c-${id}`).value
                });
            }
        }

        if (total > 0) {
            tg.MainButton.setText(`–û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó: ${total}‚ÇΩ`);
            tg.MainButton.show();
        } else {
            tg.MainButton.hide();
        }

        tg.MainButton.offClick(handleMainButtonClick); 
        tg.MainButton.onClick(handleMainButtonClick);

        function handleMainButtonClick() {
            if (orderData.length > 0) {
                tg.sendData(JSON.stringify(orderData));
            }
        }
    };

    render();
</script>
</body>
</html>
