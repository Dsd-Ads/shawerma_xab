<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-theme-bg-color: #ffffff;
            --tg-theme-secondary-bg-color: #f5f5f5;
            --tg-theme-button-color: #248b91;
            --tg-theme-text-color: #222222;
            --tg-theme-hint-color: #707579;
        }
        body { font-family: -apple-system, sans-serif; background: var(--tg-theme-bg-color); color: var(--tg-theme-text-color); margin: 0; padding: 10px; padding-bottom: 100px; }
        .category { font-size: 1rem; font-weight: 800; text-transform: uppercase; color: var(--tg-theme-button-color); margin: 25px 0 10px; border-bottom: 2px solid; padding-bottom: 5px; }
        .item-card { background: var(--tg-theme-secondary-bg-color); border-radius: 12px; padding: 12px; margin-bottom: 10px; }
        .item-header { display: flex; justify-content: space-between; font-weight: bold; }
        .item-desc { font-size: 0.75rem; color: var(--tg-theme-hint-color); margin: 4px 0; }
        .controls { display: flex; align-items: center; justify-content: space-between; margin-top: 10px; }
        .qty-box { display: flex; align-items: center; gap: 15px; }
        .btn-qty { background: var(--tg-theme-button-color); color: white; border: none; border-radius: 6px; width: 34px; height: 34px; font-size: 1.2rem; cursor: pointer; }
        .addon-block { display: none; margin-top: 10px; padding-top: 10px; border-top: 1px solid #ddd; }
        .addons-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; font-size: 0.75rem; }
        textarea { width: 100%; box-sizing: border-box; margin-top: 8px; border-radius: 8px; border: 1px solid #ccc; padding: 8px; font-size: 0.8rem; resize: none; font-family: inherit; }
        .price { font-weight: 900; color: var(--tg-theme-button-color); }
        .badge-size { background: #e0e0e0; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; vertical-align: middle; margin-left: 5px; color: #555; }
    </style>
</head>
<body>

<div id="menu-container"></div>

<script>
    let tg = window.Telegram.WebApp;
    tg.expand();

    const menuData = [
        {
            category: "ðŸŒ¯ Ð¨ÐÐ£Ð ÐœÐ",
            items: [
                { id: "sh_kur_st", name: "Ð¨Ð°ÑƒÑ€Ð¼Ð° ÐšÑƒÑ€Ð¸Ñ†Ð° (Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚)", price: 290, desc: "ÐžÐ²Ð¾Ñ‰Ð¸, ÑÐ¾ÑƒÑÑ‹, ÐºÐ¾Ñ€ÐµÐ¹ÑÐºÐ°Ñ Ð¼Ð¾Ñ€ÐºÐ¾Ð²ÑŒ" },
                { id: "sh_kur_big", name: "Ð¨Ð°ÑƒÑ€Ð¼Ð° ÐšÑƒÑ€Ð¸Ñ†Ð° (Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ)", price: 350, desc: "ÐžÐ²Ð¾Ñ‰Ð¸, ÑÐ¾ÑƒÑÑ‹, ÐºÐ¾Ñ€ÐµÐ¹ÑÐºÐ°Ñ Ð¼Ð¾Ñ€ÐºÐ¾Ð²ÑŒ" },
                { id: "sh_svin_st", name: "Ð¨Ð°ÑƒÑ€Ð¼Ð° Ð¡Ð²Ð¸Ð½Ð¸Ð½Ð° (Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚)", price: 320, desc: "ÐšÐ°Ð¿ÑƒÑÑ‚Ð°, Ð¾Ð²Ð¾Ñ‰Ð¸, Ð¼Ð°Ñ€Ð¸Ð½Ð¾Ð². Ð»ÑƒÐº" },
                { id: "sh_svin_big", name: "Ð¨Ð°ÑƒÑ€Ð¼Ð° Ð¡Ð²Ð¸Ð½Ð¸Ð½Ð° (Ð‘Ð¾Ð»ÑŒÑˆÐ°Ñ)", price: 380, desc: "ÐšÐ°Ð¿ÑƒÑÑ‚Ð°, Ð¾Ð²Ð¾Ñ‰Ð¸, Ð¼Ð°Ñ€Ð¸Ð½Ð¾Ð². Ð»ÑƒÐº" },
                { id: "sh_hub", name: "ðŸŒŸ Ð¨Ð°ÑƒÑ€Ð¼Ð° Ð¥ÐÐ‘", price: 390, desc: "ÐšÑƒÑ€Ð¸Ñ†Ð°, Ð¾Ð²Ð¾Ñ‰Ð¸ Ð½Ð° Ð¼Ð°Ð½Ð³Ð°Ð»Ðµ, Ð°Ð´Ð¶Ð¸ÐºÐ°, Ñ„ÐµÑ‚Ð°" },
                { id: "sh_fish", name: "ðŸŸ Ð¨Ð°ÑƒÑ€Ð¼Ð° Ð¡ÐºÑƒÐ¼Ð±Ñ€Ð¸Ñ", price: 340, desc: "Ð¡ÐºÑƒÐ¼Ð±Ñ€Ð¸Ñ Ð·Ð°Ð¿ÐµÑ‡ÐµÐ½Ð½Ð°Ñ, Ñ‚ÐµÑ€Ð¸ÑÐºÐ¸, Ð¾Ð²Ð¾Ñ‰Ð¸" }
            ]
        },
        {
            category: "ðŸ” Ð‘Ð£Ð Ð“Ð•Ð Ð« & Ð¤ÐÐ¡Ð¢-Ð¤Ð£Ð”",
            items: [
                { id: "brg_black", name: "Ð‘ÑƒÑ€Ð³ÐµÑ€ Ð‘Ð»ÑÐº", price: 460, desc: "Ð¡Ð²Ð¸Ð½Ð¾-Ð³Ð¾Ð²ÑÐ¶ÑŒÑ ÐºÐ¾Ñ‚Ð»ÐµÑ‚Ð°, Ð¾Ð²Ð¾Ñ‰Ð¸" },
                { id: "brg_tiftik", name: "Ð¢Ð¸Ñ„Ñ‚Ð¸Ðº Ð‘ÑƒÑ€Ð³ÐµÑ€", price: 570, desc: "Ð Ð²Ð°Ð½Ð°Ñ Ð³Ð¾Ð²ÑÐ´Ð¸Ð½Ð°, Ð¼Ð¾Ñ†Ð°Ñ€ÐµÐ»Ð»Ð°" },
                { id: "burrito", name: "Ð‘ÑƒÑ€Ñ€Ð¸Ñ‚Ð¾", price: 450, desc: "ÐšÑƒÑ€Ð¸Ñ†Ð°, Ñ„Ð°ÑÐ¾Ð»ÑŒ, Ñ…Ð°Ð»Ð°Ð¿ÐµÐ½ÑŒÐ¾, ÑÑ‹Ñ€" },
                { id: "hotdog_cl", name: "Ð¥Ð¾Ñ‚-Ð”Ð¾Ð³ ÐšÐ»Ð°ÑÑÐ¸Ðº", price: 190, desc: "Ð¡Ð¾ÑÐ¸ÑÐºÐ°, Ð±ÑƒÐ»ÐºÐ°, ÐºÐµÑ‚Ñ‡ÑƒÐ¿, Ð³Ð¾Ñ€Ñ‡Ð¸Ñ†Ð°" },
                { id: "hotdog_fr", name: "Ð¥Ð¾Ñ‚-Ð”Ð¾Ð³ Ð¤Ñ€ÐµÐ½Ñ‡", price: 210, desc: "Ð¤Ñ€Ð°Ð½Ñ†ÑƒÐ·ÑÐºÐ°Ñ Ð±ÑƒÐ»Ð¾Ñ‡ÐºÐ°, ÑÐ¾ÑÐ¸ÑÐºÐ°" }
            ]
        },
        {
            category: "ðŸ”¥ ÐœÐÐÐ“ÐÐ›",
            items: [
                { id: "m_bedro", name: "Ð¨Ð°ÑˆÐ»Ñ‹Ðº ÐšÑƒÑ€Ð¸Ð½Ð¾Ðµ Ð±ÐµÐ´Ñ€Ð¾", price: 440, desc: "250/80 Ð³ Ð¿Ð¾Ñ€Ñ†Ð¸Ñ" },
                { id: "m_svin", name: "Ð¨Ð°ÑˆÐ»Ñ‹Ðº Ð¡Ð²Ð¸Ð½Ð¸Ð½Ð°", price: 490, desc: "250/80 Ð³ Ð¿Ð¾Ñ€Ñ†Ð¸Ñ" },
                { id: "m_lulya", name: "Ð›ÑŽÐ»Ñ ÐºÑƒÑ€Ð¸Ð½Ñ‹Ðµ", price: 260, desc: "125/70 Ð³" }
            ]
        },
        {
            category: "ðŸŽ ÐšÐžÐœÐ‘Ðž ÐžÐ‘Ð•Ð”Ð«",
            items: [
                { id: "c1", name: "ÐšÐ¾Ð¼Ð±Ð¾ â„–1", price: 500, desc: "Ð¥Ð¾Ñ‚-Ð´Ð¾Ð³, Ñ„Ñ€Ð¸, Ð½Ð°Ð¿Ð¸Ñ‚Ð¾Ðº, ÑÐ¾ÑƒÑ" },
                { id: "c2", name: "ÐšÐ¾Ð¼Ð±Ð¾ â„–2", price: 550, desc: "Ð‘Ð»ÑÐº Ð±ÑƒÑ€Ð³ÐµÑ€, Ñ…Ð°ÑˆÐ±Ñ€Ð°ÑƒÐ½, Ð½Ð°Ð¿Ð¸Ñ‚Ð¾Ðº" },
                { id: "c3", name: "ÐšÐ¾Ð¼Ð±Ð¾ â„–3", price: 520, desc: "Ð¨Ð°ÑƒÑ€Ð¼Ð° ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚, Ñ„Ñ€Ð¸, Ð½Ð°Ð¿Ð¸Ñ‚Ð¾Ðº" }
            ]
        },
        {
            category: "â˜•ï¸ ÐÐÐŸÐ˜Ð¢ÐšÐ˜ & Ð”Ð•Ð¡Ð•Ð Ð¢Ð«",
            items: [
                { id: "d_trub", name: "Ð’Ð°Ñ„ÐµÐ»ÑŒÐ½Ð°Ñ Ñ‚Ñ€ÑƒÐ±Ð¾Ñ‡ÐºÐ°", price: 150, desc: "Ð¡ Ð²Ð°Ñ€ÐµÐ½Ð¾Ð¹ ÑÐ³ÑƒÑ‰ÐµÐ½ÐºÐ¾Ð¹" },
                { id: "n_lim", name: "Ð›Ð¸Ð¼Ð¾Ð½Ð°Ð´ (350 Ð¼Ð»)", price: 170, desc: "Ð’ Ð°ÑÑÐ¾Ñ€Ñ‚Ð¸Ð¼ÐµÐ½Ñ‚Ðµ" },
                { id: "n_cofe", name: "ÐšÐ°Ð¿ÑƒÑ‡Ð¸Ð½Ð¾ / Ð›Ð°Ñ‚Ñ‚Ðµ", price: 190, desc: "220 Ð¼Ð»" }
            ]
        }
    ];

    const addons = [
        { n: "ðŸ§€ Ð¡Ñ‹Ñ€", p: 40 },
        { n: "ðŸ”¥ Ð¥Ð°Ð»Ð°Ð¿ÐµÐ½ÑŒÐ¾", p: 30 },
        { n: "ðŸŸ ÐšÐ°Ñ€Ñ‚Ð¾Ñ„ÐµÐ»ÑŒ", p: 30 },
        { n: "ðŸ¥’ ÐžÐ³ÑƒÑ€ÐµÑ† Ð¼Ð°Ñ€.", p: 20 },
        { n: "ðŸ«’ ÐœÐ°ÑÐ»Ð¸Ð½Ñ‹", p: 40 },
        { n: "ðŸŒ½ ÐšÑƒÐºÑƒÑ€ÑƒÐ·Ð°", p: 20 }
    ];

    let cart = {};

    function renderMenu() {
        const container = document.getElementById('menu-container');
        menuData.forEach(cat => {
            container.innerHTML += `<div class="category">${cat.category}</div>`;
            cat.items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'item-card';
                itemDiv.dataset.id = item.id;
                itemDiv.innerHTML = `
                    <div class="item-header"><span>${item.name}</span><span class="price">${item.price}â‚½</span></div>
                    <div class="item-desc">${item.desc}</div>
                    <div class="controls">
                        <div class="qty-box">
                            <button class="btn-qty" onclick="updateQty('${item.id}', -1, ${item.price})">-</button>
                            <span id="q-${item.id}">0</span>
                            <button class="btn-qty" onclick="updateQty('${item.id}', 1, ${item.price})">+</button>
                        </div>
                    </div>
                    <div class="addon-block" id="ab-${item.id}">
                        <div class="addons-grid">
                            ${addons.map(a => `<label><input type="checkbox" class="cb" data-n="${a.n}" data-p="${a.p}" onchange="calc()"> ${a.n} (+${a.p}â‚½)</label>`).join('')}
                        </div>
                        <textarea placeholder="Ð’Ð°Ñˆ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ (Ð±ÐµÐ· Ð»ÑƒÐºÐ° Ð¸ Ñ‚.Ð´.)..."></textarea>
                    </div>
                `;
                container.appendChild(itemDiv);
            });
        });
    }

    function updateQty(id, delta, price) {
        if (!cart[id]) {
            const el = document.querySelector(`[data-id="${id}"]`);
            cart[id] = { qty: 0, name: el.querySelector('.item-header span').innerText, price: price };
        }
        cart[id].qty += delta;
        if (cart[id].qty < 0) cart[id].qty = 0;
        document.getElementById(`q-${id}`).innerText = cart[id].qty;
        document.getElementById(`ab-${id}`).style.display = cart[id].qty > 0 ? 'block' : 'none';
        calc();
    }

    function calc() {
        let total = 0;
        for (let id in cart) {
            if (cart[id].qty > 0) {
                total += cart[id].qty * cart[id].price;
                const card = document.querySelector(`[data-id="${id}"]`);
                card.querySelectorAll('.cb:checked').forEach(cb => total += parseInt(cb.dataset.p));
            }
        }
        if (total > 0) {
            tg.MainButton.setText(`Ð—ÐÐšÐÐ—ÐÐ¢Ð¬ (${total}â‚½)`);
            tg.MainButton.show();
        } else {
            tg.MainButton.hide();
        }
    }

    tg.onEvent('mainButtonClicked', () => {
        let order = [];
        for (let id in cart) {
            if (cart[id].qty > 0) {
                const card = document.querySelector(`[data-id="${id}"]`);
                order.push({
                    name: cart[id].name,
                    qty: cart[id].qty,
                    addons: Array.from(card.querySelectorAll('.cb:checked')).map(cb => cb.dataset.n),
                    comment: card.querySelector('textarea').value
                });
            }
        }
        tg.sendData(JSON.stringify(order));
    });

    renderMenu();
</script>
</body>
</html>
