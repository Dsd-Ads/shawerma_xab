<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–®–∞—É—Ä–º–∞ –•–∞–± ‚Äî –ü–æ–ª–Ω–æ–µ –ú–µ–Ω—é</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: var(--tg-theme-bg-color, #ffffff);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #f4f4f5);
            --text-color: var(--tg-theme-text-color, #000000);
            --hint-color: var(--tg-theme-hint-color, #999999);
            --button-color: var(--tg-theme-button-color, #248b91);
            --button-text: var(--tg-theme-button-text-color, #ffffff);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0; padding: 0;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        header {
            background-color: var(--bg-color);
            position: sticky; top: 0; z-index: 100;
            padding: 12px; text-align: center; font-weight: 800;
            border-bottom: 0.5px solid rgba(0,0,0,0.1);
        }

        .category-header {
            padding: 20px 16px 8px; font-size: 14px; font-weight: 700;
            color: var(--button-color); text-transform: uppercase; letter-spacing: 1px;
        }

        .item-card {
            background: var(--bg-color);
            border-bottom: 0.5px solid rgba(0,0,0,0.05);
            padding: 16px;
        }

        .item-main { display: flex; justify-content: space-between; align-items: flex-start; }
        .item-info { flex: 1; }
        .item-title { font-size: 16px; font-weight: 600; margin-bottom: 4px; }
        .item-desc { font-size: 13px; color: var(--hint-color); line-height: 1.2; }
        
        .price-row { display: flex; align-items: center; justify-content: flex-end; gap: 12px; margin-top: 10px; }
        .price { font-weight: 700; font-size: 16px; }

        /* –ö–Ω–æ–ø–∫–∏ –∏ —Å—á–µ—Ç—á–∏–∫ */
        .add-btn {
            background-color: var(--secondary-bg); color: var(--button-color); border: none;
            padding: 6px 16px; border-radius: 12px; font-weight: 700; cursor: pointer;
        }
        .counter {
            display: none; align-items: center; background-color: var(--button-color);
            color: var(--button-text); border-radius: 12px; padding: 2px;
        }
        .counter button {
            background: none; border: none; color: white; width: 32px; height: 32px; font-size: 20px; font-weight: bold;
        }
        .count-num { width: 24px; text-align: center; font-weight: 700; }

        /* –ù–ê–°–õ–û–ï–ù–ò–ï (–î–û–ë–ê–í–ö–ò –ò –ö–û–ú–ë–û-–í–´–ë–û–†) */
        .addon-section {
            display: none; margin-top: 15px; padding: 12px;
            background-color: var(--secondary-bg); border-radius: 12px;
        }

        .combo-select-wrapper { margin-bottom: 12px; }
        .combo-label { font-size: 11px; font-weight: 800; color: var(--hint-color); text-transform: uppercase; margin-bottom: 4px; display: block; }
        .combo-select {
            width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(0,0,0,0.1);
            background: var(--bg-color); color: var(--text-color); font-size: 14px;
        }

        .addon-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .addon-item {
            display: flex; align-items: center; font-size: 13px;
            background: var(--bg-color); padding: 8px; border-radius: 8px;
        }
        .addon-item input { margin-right: 8px; width: 16px; height: 16px; }

        textarea {
            width: 100%; margin-top: 10px; border-radius: 8px; border: 1px solid rgba(0,0,0,0.1);
            padding: 10px; font-family: inherit; font-size: 13px; background: var(--bg-color);
            color: var(--text-color); box-sizing: border-box; resize: none;
        }

        .bottom-space { height: 100px; }
    </style>
</head>
<body>

<header>–®–ê–£–†–ú–ê –•–ê–ë</header>
<div id="menu-list"></div>
<div class="bottom-space"></div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const listDrinks = ["–ö–æ–ª–∞ 0.5", "–ú–æ—Ä—Å", "–í–æ–¥–∞", "–ß–∞–π"];
    const listSauces = ["–°—ã—Ä–Ω—ã–π", "–ß–µ—Å–Ω–æ—á–Ω—ã–π", "–ê–¥–∂–∏–∫–∞", "–ö–µ—Ç—á—É–ø"];

    const menuData = [
        {
            category: "üéÅ –í—ã–≥–æ–¥–Ω—ã–µ –ö–æ–º–±–æ",
            items: [
                { id: "c1", name: "–ö–æ–º–±–æ 1", price: 450, desc: "–•–æ—Ç-–¥–æ–≥, —Ñ—Ä–∏, —Å–æ—É—Å –∏ –Ω–∞–ø–∏—Ç–æ–∫", opts: [{l: "–ù–∞–ø–∏—Ç–æ–∫", d: listDrinks}, {l: "–°–æ—É—Å", d: listSauces}] },
                { id: "c2", name: "–ö–æ–º–±–æ 2", price: 550, desc: "–ë–ª—ç–∫ –±—É—Ä–≥–µ—Ä, —Ö–∞—à–±—Ä–∞—É–Ω –∏ –Ω–∞–ø–∏—Ç–æ–∫", opts: [{l: "–ù–∞–ø–∏—Ç–æ–∫", d: listDrinks}] },
                { id: "c3", name: "–ö–æ–º–±–æ 3", price: 580, desc: "–ì—Ä–∏–±–±—É—Ä–≥–µ—Ä, —Ñ—Ä–∏, —Å–æ—É—Å –∏ –Ω–∞–ø–∏—Ç–æ–∫", opts: [{l: "–ù–∞–ø–∏—Ç–æ–∫", d: listDrinks}, {l: "–°–æ—É—Å", d: listSauces}] },
                { id: "c4", name: "–ö–æ–º–±–æ 4", price: 620, desc: "–°—É–ø –ª–∞–ø—à–∞, —Å–∞–ª–∞—Ç –¶–µ–∑–∞—Ä—å, —Ö–∞—à–±—Ä–∞—É–Ω –∏ –Ω–∞–ø–∏—Ç–æ–∫", opts: [{l: "–ù–∞–ø–∏—Ç–æ–∫", d: listDrinks}] },
                { id: "c5", name: "–ö–æ–º–±–æ 5", price: 560, desc: "–§–∏—à–±—É—Ä–≥–µ—Ä, —Ñ—Ä–∏, —Å–æ—É—Å –∏ –Ω–∞–ø–∏—Ç–æ–∫", opts: [{l: "–ù–∞–ø–∏—Ç–æ–∫", d: listDrinks}, {l: "–°–æ—É—Å", d: listSauces}] },
                { id: "c6", name: "–ö–æ–º–±–æ 6", price: 690, desc: "–¢–∏—Ñ—Ç–∏–∫ –±—É—Ä–≥–µ—Ä, —Ö–∞—à–±—Ä–∞—É–Ω –∏ –Ω–∞–ø–∏—Ç–æ–∫", opts: [{l: "–ù–∞–ø–∏—Ç–æ–∫", d: listDrinks}] }
            ]
        },
        {
            category: "üåØ –®–∞—É—Ä–º–∞",
            items: [
                { id: "sh_kur_st", name: "–®–∞—É—Ä–º–∞ –∫—É—Ä–∏—Ü–∞ (–°—Ç–∞–Ω–¥–∞—Ä—Ç)", price: 290, desc: "390–≥. –û–≤–æ—â–∏, —Å–æ—É—Å—ã" },
                { id: "sh_svin_st", name: "–®–∞—É—Ä–º–∞ —Å–≤–∏–Ω–∏–Ω–∞ (–°—Ç–∞–Ω–¥–∞—Ä—Ç)", price: 320, desc: "390–≥. –ú—è—Å–æ –Ω–∞ —É–≥–ª—è—Ö" },
                { id: "sh_hab", name: "üåü –®–∞—É—Ä–º–∞ –•–ê–ë", price: 390, desc: "–û–≤–æ—â–∏ –≥—Ä–∏–ª—å, –∞–¥–∂–∏–∫–∞, —Å–æ—É—Å —Ñ–µ—Ç–∞" }
            ]
        },
        {
            category: "ü•™ –°—ç–Ω–¥–≤–∏—á–∏ & –¢–æ—Ä—Ç–∏–ª—å—è",
            items: [
                { id: "burrito", name: "–ë—É—Ä—Ä–∏—Ç–æ", price: 450, desc: "–ö—É—Ä–∏—Ü–∞, —Ñ–∞—Å–æ–ª—å, —Ö–∞–ª–∞–ø–µ–Ω—å–æ" },
                { id: "tort_krev", name: "–¢–æ—Ä—Ç–∏–ª—å—è –∫—Ä–µ–≤–µ—Ç–∫–∏", price: 370, desc: "–ö—Ä–µ–≤–µ—Ç–∫–∏ –ø–∞–Ω–∫–æ, —Ç–æ–º–∞—Ç" }
            ]
        },
        {
            category: "üçî –ë—É—Ä–≥–µ—Ä—ã",
            items: [
                { id: "br_black", name: "–ë—É—Ä–≥–µ—Ä –ë–ª—ç–∫", price: 460, desc: "–ß–µ—Ä–Ω–∞—è –±—É–ª–∫–∞, –∫–æ—Ç–ª–µ—Ç–∞ –≥–æ–≤—è–∂—å—è" },
                { id: "br_tiftik", name: "–¢–∏—Ñ—Ç–∏–∫ –±—É—Ä–≥–µ—Ä", price: 570, desc: "–†–≤–∞–Ω–∞—è –≥–æ–≤—è–¥–∏–Ω–∞" }
            ]
        }
    ];

    const addons = [{ n: "üßÄ –°—ã—Ä", p: 40 }, { n: "üî• –•–∞–ª–∞–ø–µ–Ω—å–æ", p: 30 }, { n: "üçü –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å", p: 30 }];
    let cart = {};

    function render() {
        const list = document.getElementById('menu-list');
        menuData.forEach(cat => {
            const catTitle = document.createElement('div');
            catTitle.className = 'category-header';
            catTitle.innerText = cat.category;
            list.appendChild(catTitle);

            cat.items.forEach(item => {
                const optsHTML = item.opts ? item.opts.map(o => `
                    <div class="combo-select-wrapper">
                        <label class="combo-label">${o.l}</label>
                        <select class="combo-select" onchange="recalc()">
                            ${o.d.map(v => `<option value="${v}">${v}</option>`).join('')}
                        </select>
                    </div>
                `).join('') : '';

                const div = document.createElement('div');
                div.className = 'item-card';
                div.id = `item-${item.id}`;
                div.innerHTML = `
                    <div class="item-main">
                        <div class="item-info">
                            <div class="item-title">${item.name}</div>
                            <div class="item-desc">${item.desc}</div>
                        </div>
                        <div class="price">${item.price} ‚ÇΩ</div>
                    </div>
                    <div class="price-row">
                        <button class="add-btn" id="add-${item.id}" onclick="changeQty('${item.id}', 1, ${item.price})">–î–æ–±–∞–≤–∏—Ç—å</button>
                        <div class="counter" id="cnt-${item.id}">
                            <button onclick="changeQty('${item.id}', -1, ${item.price})">‚àí</button>
                            <span class="count-num" id="q-${item.id}">0</span>
                            <button onclick="changeQty('${item.id}', 1, ${item.price})">+</button>
                        </div>
                    </div>
                    <div class="addon-section" id="a-${item.id}">
                        ${optsHTML}
                        <div class="addon-grid">
                            ${addons.map((a, i) => `
                                <div class="addon-item">
                                    <input type="checkbox" class="cb" id="cb-${item.id}-${i}" data-p="${a.p}" data-n="${a.n}" onchange="recalc()">
                                    <label for="cb-${item.id}-${i}">${a.n} (+${a.p}‚ÇΩ)</label>
                                </div>`).join('')}
                        </div>
                        <textarea id="c-${item.id}" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –±–ª—é–¥—É..." oninput="recalc()"></textarea>
                    </div>
                `;
                list.appendChild(div);
            });
        });
    }

    window.changeQty = function(id, delta, price) {
        if (!cart[id]) cart[id] = { q: 0, p: price };
        cart[id].q += delta;
        if (cart[id].q < 0) cart[id].q = 0;

        document.getElementById(`q-${id}`).innerText = cart[id].q;
        document.getElementById(`add-${id}`).style.display = cart[id].q > 0 ? 'none' : 'block';
        document.getElementById(`cnt-${id}`).style.display = cart[id].q > 0 ? 'flex' : 'none';
        document.getElementById(`a-${id}`).style.display = cart[id].q > 0 ? 'block' : 'none';

        if (cart[id].q === 0) delete cart[id];
        recalc();
    };

    window.recalc = function() {
        let total = 0;
        let orderArr = [];

        for (const id in cart) {
            const card = document.getElementById(`item-${id}`);
            let itemPrice = cart[id].p;
            let details = [];

            // –°–æ–±–∏—Ä–∞–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏ (–ö–æ–º–±–æ)
            card.querySelectorAll('.combo-select').forEach(sel => details.push(sel.value));
            // –°–æ–±–∏—Ä–∞–µ–º –¥–æ–±–∞–≤–∫–∏
            card.querySelectorAll('.cb:checked').forEach(c => {
                itemPrice += parseInt(c.dataset.p);
                details.push(c.dataset.n);
            });

            total += itemPrice * cart[id].q;
            orderArr.push({
                item: card.querySelector('.item-title').innerText,
                quantity: cart[id].q,
                price: itemPrice,
                details: details.join(', '),
                comment: document.getElementById(`c-${id}`).value || "–Ω–µ—Ç"
            });
        }

        tg.MainButton.setText(`–û–§–û–†–ú–ò–¢–¨: ${total} ‚ÇΩ`);
        total > 0 ? tg.MainButton.show() : tg.MainButton.hide();

        tg.MainButton.offClick(sendOrder);
        tg.MainButton.onClick(sendOrder);

        function sendOrder() {
            tg.sendData(JSON.stringify(orderArr));
        }
    };

    render();
</script>
</body>
</html>
