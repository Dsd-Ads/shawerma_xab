<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ú–µ–Ω—é –®–∞—É—Ä–º–∞ –•–∞–±</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: var(--tg-theme-bg-color, #ffffff);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #f4f4f5);
            --text-color: var(--tg-theme-text-color, #000000);
            --hint-color: var(--tg-theme-hint-color, #707579);
            --button-color: var(--tg-theme-button-color, #248bed);
            --button-text: var(--tg-theme-button-text-color, #ffffff);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            margin: 0; padding: 0;
            overflow-x: hidden;
            scroll-behavior: smooth;
            -webkit-tap-highlight-color: transparent;
        }

        /* ===== Header + fast navigation (–∫–∞–∫ –≤ index.html) ===== */
        header {
            position: sticky; top: 0; z-index: 100;
            background: var(--bg-color);
            padding: 12px; text-align: center; font-weight: 600;
            border-bottom: .5px solid rgba(0,0,0,.1);
        }
        .nav-tabs {
            position: sticky; top: 45px; z-index: 99;
            display: flex; gap: 8px; overflow-x: auto;
            padding: 8px 12px; background: var(--bg-color);
            border-bottom: .5px solid rgba(0,0,0,.1);
        }
        .nav-tabs::-webkit-scrollbar { display: none; }
        .nav-btn {
            padding: 6px 16px; border-radius: 16px;
            background: var(--secondary-bg);
            color: var(--text-color); text-decoration: none;
            font-size: 14px; font-weight: 500; white-space: nowrap;
        }
        .nav-btn.active { background: var(--button-color); color: var(--button-text); }

        #app { padding: 12px; padding-bottom: 110px; }
        .section-anchor { scroll-margin-top: 110px; }

        /* ===== Categories ===== */
        .category-title {
            font-size: 14px; font-weight: 600; text-transform: uppercase;
            color: var(--hint-color); letter-spacing: .5px;
            margin: 20px 4px 8px;
        }

        /* ===== Item card (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É) ===== */
        .item-card {
            background: var(--secondary-bg);
            border-radius: 14px;
            padding: 14px;
            margin-bottom: 10px;
        }
        .item-header { display: flex; justify-content: space-between; gap: 10px; }
        .item-name { font-size: 16px; font-weight: 600; }
        .item-price { font-weight: 700; color: var(--button-color); }
        .item-desc { font-size: 13px; color: var(--hint-color); margin-top: 4px; }

        .controls { display: flex; justify-content: flex-end; margin-top: 10px; }
        .qty-box {
            display: flex; align-items: center;
            background: var(--bg-color); border-radius: 14px; padding: 3px;
        }
        .btn-qty {
            background: var(--button-color); color: var(--button-text);
            border: none; border-radius: 12px;
            width: 32px; height: 28px; font-size: 18px; font-weight: 700;
        }
        .qty-num { width: 24px; text-align: center; font-weight: 600; }

        /* ===== Addons + comments (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –ª–æ–≥–∏–∫–µ) ===== */
        .addon-section {
            display: none; margin-top: 10px; padding-top: 10px;
            border-top: 1px dashed rgba(0,0,0,.15);
        }
        .addon-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .addon-item {
            display: flex; align-items: center; gap: 6px;
            font-size: 12px; background: var(--bg-color);
            padding: 8px; border-radius: 10px;
        }
        textarea {
            width: 100%; margin-top: 8px; resize: none;
            border-radius: 10px; padding: 8px;
            border: 1px solid rgba(0,0,0,.1);
            background: var(--bg-color); color: var(--text-color);
            font-size: 13px;
        }
    </style>
</head>
<body>

<header>–®–∞—É—Ä–º–∞ –•–∞–±</header>
<div class="nav-tabs" id="nav"></div>

<div id="app">
    <div id="menu-content"></div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready(); tg.expand();

/* ===== DATA (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ===== */
const menuData = [
    { category: 'üåØ –®–∞—É—Ä–º–∞', id: 'shawarma', items: [
        { id: 'sh_kur_st', name: '–®–∞—É—Ä–º–∞ –∫—É—Ä–∏—Ü–∞ (–°—Ç–∞–Ω–¥–∞—Ä—Ç)', price: 290, desc: '390–≥. –û–≤–æ—â–∏, —Å–æ—É—Å—ã, –∫–æ—Ä–µ–π—Å–∫–∞—è –º–æ—Ä–∫–æ–≤—å' },
        { id: 'sh_kur_big', name: '–®–∞—É—Ä–º–∞ –∫—É—Ä–∏—Ü–∞ (–ë–æ–ª—å—à–∞—è)', price: 350, desc: '500–≥. –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –ø–æ—Ä—Ü–∏—è' },
        { id: 'sh_svin_st', name: '–®–∞—É—Ä–º–∞ —Å–≤–∏–Ω–∏–Ω–∞ (–°—Ç–∞–Ω–¥–∞—Ä—Ç)', price: 320, desc: '390–≥. –û–≤–æ—â–∏, —Å–æ—É—Å—ã, –º–∞—Ä–∏–Ω–æ–≤–∞–Ω–Ω—ã–π –ª—É–∫' }
    ]},
    { category: 'üçü –ó–∞–∫—É—Å–∫–∏', id: 'snacks', items: [
        { id: 'z_fri', name: '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å —Ñ—Ä–∏', price: 130, desc: '100–≥. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π' },
        { id: 'z_nag', name: '–ù–∞–≥–≥–µ—Ç—Å—ã', price: 190, desc: '6 —à—Ç.' }
    ]}
];

const addons = [
    { n: 'üßÄ –°—ã—Ä', p: 40 },
    { n: 'üî• –•–∞–ª–∞–ø–µ–Ω—å–æ', p: 30 },
    { n: 'ü•í –û–≥—É—Ä–µ—Ü', p: 20 }
];

let cart = {};

/* ===== RENDER ===== */
function render() {
    const nav = document.getElementById('nav');
    const wrap = document.getElementById('menu-content');
    nav.innerHTML = ''; wrap.innerHTML = '';

    menuData.forEach((cat, i) => {
        nav.innerHTML += `<a href="#cat-${cat.id}" class="nav-btn ${i===0?'active':''}" onclick="setActive(this)">${cat.category}</a>`;

        wrap.innerHTML += `<div id="cat-${cat.id}" class="section-anchor"><div class="category-title">${cat.category}</div></div>`;

        cat.items.forEach(item => {
            wrap.innerHTML += `
            <div class="item-card" id="item-${item.id}">
                <div class="item-header">
                    <div class="item-name">${item.name}</div>
                    <div class="item-price">${item.price}‚ÇΩ</div>
                </div>
                <div class="item-desc">${item.desc}</div>
                <div class="controls">
                    <div class="qty-box">
                        <button class="btn-qty" onclick="changeQty('${item.id}',-1,${item.price})">‚àí</button>
                        <span class="qty-num" id="q-${item.id}">0</span>
                        <button class="btn-qty" onclick="changeQty('${item.id}',1,${item.price})">+</button>
                    </div>
                </div>
                <div class="addon-section" id="a-${item.id}">
                    <div class="addon-grid">
                        ${addons.map(a=>`<label class="addon-item"><input type="checkbox" class="cb" data-p="${a.p}" data-n="${a.n}" onchange="recalc()">${a.n} (+${a.p}‚ÇΩ)</label>`).join('')}
                    </div>
                    <textarea id="c-${item.id}" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –±–ª—é–¥—É"></textarea>
                </div>
            </div>`;
        });
    });
}

function setActive(el){
    document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
    el.classList.add('active');
}

window.changeQty = function(id, d, p){
    if(!cart[id]) cart[id]={q:0,p:p};
    cart[id].q = Math.max(0, cart[id].q + d);
    document.getElementById('q-'+id).innerText = cart[id].q;
    document.getElementById('a-'+id).style.display = cart[id].q>0?'block':'none';
    recalc();
}

window.recalc = function(){
    let total=0, order=[];
    for(const id in cart){
        if(cart[id].q>0){
            let sum = cart[id].q*cart[id].p;
            const card=document.getElementById('item-'+id);
            const ads=[];
            card.querySelectorAll('.cb:checked').forEach(c=>{sum+=+c.dataset.p; ads.push(c.dataset.n);});
            total+=sum;
            order.push({name:card.querySelector('.item-name').innerText,q:cart[id].q,addons:ads,comment:document.getElementById('c-'+id).value});
        }
    }
    if(total>0){ tg.MainButton.setText(`–û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó ‚Äî ${total}‚ÇΩ`); tg.MainButton.show(); }
    else tg.MainButton.hide();

    tg.MainButton.onClick(()=>{ if(order.length) tg.sendData(JSON.stringify(order)); });
}

render();
</script>
</body>
</html>
